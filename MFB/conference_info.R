conf_url <- "https://api.collegefootballdata.com/conferences"
cfb_conf_types_df <- fromJSON(conf_url)
cfb_conf_types_df$short_name <- cfb_conf_types_df$short_name %>% str_replace("Conference", "") %>% trimws()
cfb_conf_types_df$short_name[6] <- "Conference USA"

conference_team <- function(conference) {
  ### check whether conference exists
  base_url <-
    "https://api.collegefootballdata.com/teams?conference="
  if(nchar(conference)==3){
    assert_that(conference  %in%  conf_types_df$abbreviation,msg = "Incorrect conference abbreivation, potential misspelling")
    url <- paste0(base_url, conference)
  }else{
    assert_that(conference  %in%  conf_types_df$short_name,msg="Incorrect conference selection, potential misspelling")
    ind <- which(conference == conf_types_df$short_name)
    url <- paste0(base_url,conf_types_df$abbreviation[ind])
  }
  df <- fromJSON(url)
  return(df)
}

s <- conference_team("SCC")
